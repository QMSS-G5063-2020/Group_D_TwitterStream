---
title: "Untitled"
author: "Lemon Reimer"
date: "2/28/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(reticulate)
library(rtweet)
library(ggplot2)

#points to where python is on your local
use_python("C:/Users/swagj/AppData/Local/Continuum/anaconda3/python.exe")

#sets base directory
knitr::opts_knit$set(root.dir = normalizePath("C:\\Users\\swagj\\Documents\\GitHub\\TwitterNetworkStreaming\\Lemon_Streamer_Tweepy"))
```

```{r initialize python object}
source_python("Lemon_ML.py", convert = T)
```

```{r API keys}

#after the first call, this info is saved to environ

#ckey=""
#csecret=""
#atoken=""
#asecret=""

#token <- create_token(
  #app = "LemonAPIApp",
  #consumer_key = ckey,
  #consumer_secret = csecret,
  #access_token = atoken,
  #access_secret = asecret)
```

```{r}
query <- "COVID"
streamtime <- 2
filename <- "teststream.json"

#for (tweet in stream_tweets(q = query, timeout = streamtime, file_name = filename)$text){
    #print(tweet)
#}

timer <- 1
rt <- stream_tweets(q = query, timeout = streamtime, file_name = filename)
rt <- rt[rt$lang == "en",]
repeat {
  temp_rt <- stream_tweets(q = query, timeout = streamtime, file_name = filename)
  temp_rt <- temp_rt[temp_rt$lang == "en",]
  rt <- rbind(rt, temp_rt)
  timer <- timer + 1
  #for (tweet in temp_rt$text){
    #print(tweet)
  #}
  print(ggplot(rt, aes(x = source)) + geom_bar())
  if (timer == 5){
    break
  }
}
```

```{r}
#ts_plot(rt, by = 'secs', trim = 1)
ggplot(rt, aes(x = source)) + geom_bar()
```

